module AdventOfCode.Tests.Y2021.Day20Tests

open System
open AdventOfCode.Cases.Infrastructure
open AdventOfCode.Cases.Y2021.Day20
open Xunit
open Swensen.Unquote

let algorithm, image =
    "..#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#

#..#.
#....
##..#
..#..
..###" |> parse

let sourceRun =  run algorithm image

let exampleStep1 =
    "
.##.##.
#..#.#.
##.#..#
####..#
.#..##.
..##..#
...#.#." |> parseImage

let exampleStep2 =
    "
.......#.
.#..#.#..
#.#...###
#...##.#.
#.....#.#
.#.#####.
..#.#####
...##.##.
....###.." |> parseImage

[<Fact>]
let ``Example step 1``() =
    let actual = sourceRun 1
    test <@ actual = exampleStep1 @>

[<Fact>]
let ``Example step 2``() =
    let actual = sourceRun 2
    test <@ actual = exampleStep2 @>

[<Fact>]
let ``Example count``() =
    let actual = sourceRun 2 |> count
    test <@ actual = 35 @>

[<Fact>]
let ``Example count B``() =
    let actual = sourceRun 50 |> count
    test <@ actual = 3351 @>

[<Fact>]
let ``Initializer``() =
    let actual = initializer algorithm image 6 6
    test <@ actual = 0 @>

let algorithm2, image2 =
    "#.#.#..#####.#.#.#.###.##.....###.##.#..###.####..#####..#....#..#..##..###..######.###...####..#..#####..##..#.#####...##.#.#..#.##..#.#......#.###.######.###.####...#.##.##..#..#..#####.....#.#....###..#.##......#.....#..#..#..##..#...##.######.####.####.#.#...#.......#..#.#.#...####.##.#......#..#...##.#.##..#...##.#.##..###.#......#.#.......#.#.#.####.###.##...#.....####.#..#..#.##.#....##..#.####....##...##..#...#......#.#.......#.......##..####..#...#.#.#...##..#.#..###..#####........#..####......#..#

." |> parse

[<Fact>]
let ``Debug``() =
    let actual =  run algorithm2 image2 1
    test <@ actual = array2D [[1;1;1];[1;1;1];[1;1;1]] @>
